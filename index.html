<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CV / Lettre PWA</title>
<link rel="manifest" href="manifest.json">
<style>
body{font-family:Arial,sans-serif;background:#f0f8ff;margin:0;padding:10px}
section{background:#fff;padding:10px;border-radius:10px;margin-bottom:10px;box-shadow:0 2px 5px rgba(0,0,0,0.1)}
input,textarea,button{width:100%;padding:8px;margin:6px 0;border:1px solid #1e90ff;border-radius:6px}
button{cursor:pointer}
button.primary{background:#25D366;color:#fff;font-weight:700;border:none}
button:disabled{opacity:0.5;cursor:not-allowed}
#popupOverlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.6);justify-content:center;align-items:center}
#popup{background:#fff;padding:15px;border-radius:10px;width:100%;max-width:400px}
.error{color:#b00020}
.success{color:#006400}
</style>
</head>
<body>

<h1>üìÑ CV / Lettre de Motivation</h1>

<section>
<h2>Nom & Profession</h2>
<input id="fullName" placeholder="Nom complet">
<input id="profession" placeholder="Profession / poste">
</section>

<section>
<h2>CV</h2>
<input id="prenom" placeholder="Pr√©nom">
<input id="age" placeholder="√Çge">
<input id="ville" placeholder="Ville">
<input id="quartier" placeholder="Quartier">
<input id="situation" placeholder="Situation matrimoniale">
<input id="enfants" placeholder="Nombre d'enfants">
<input id="poste" placeholder="Dernier poste">
<input id="loisirs" placeholder="Loisirs">
<input id="caractere" placeholder="Caract√®re">
<input id="diplome" placeholder="Dernier dipl√¥me">
<input id="etablissement" placeholder="√âtablissement">
<input id="alcool" placeholder="Alcoolique Oui/Non">
<input id="salaire" placeholder="Salaire">
<input id="email" placeholder="Email">
<input id="telMtn" placeholder="Tel MTN">
<input id="telOrange" placeholder="Tel Orange">
</section>

<section>
<h2>Lettre de motivation</h2>
<input id="prenomLetter" placeholder="Pr√©nom">
<input id="nomLetter" placeholder="Nom">
<input id="entreprise" placeholder="Entreprise">
<input id="posteLetter" placeholder="Poste souhait√©">
<textarea id="contenu" placeholder="Contenu"></textarea>
</section>

<section>
<h2>Plan de localisation</h2>
<textarea id="plan" placeholder="Plan de localisation"></textarea>
</section>

<button id="shareBtn" class="primary">üì§ Partager sur WhatsApp / T√©l√©charger</button>

<!-- Popup de paiement pour utilisateurs classiques -->
<div id="popupOverlay">
<div id="popup">
<h2>Paiement requis</h2>
<p>B√©n√©ficiaire: Wirnkar Loveline</p>
<p>MTN MoMo: 676353859<br>OM: 640647072<br>Montant: 25 FCFA</p>
<textarea id="momoMsg" placeholder="Message Mobile Money"></textarea>
<input id="adminCode" type="password" placeholder="Code admin">
<div id="result"></div>

<button id="validateAdminBtn" class="primary">‚úÖ Valider code admin</button>
<button id="verifyBtn" class="primary" disabled>‚úÖ V√©rifier & Partager</button>
<button onclick="document.getElementById('popupOverlay').style.display='none'">Annuler</button>
</div>
</div>

<script>
const EXPECTED={phones:['676353859','640647072'],amount:25,admin:'233233',maxDelay:5};
const adminInput=document.getElementById('adminCode');
const validateBtn=document.getElementById('validateAdminBtn');
const verifyBtn=document.getElementById('verifyBtn');
const result=document.getElementById('result');
const shareBtn=document.getElementById('shareBtn');
let isAdmin=false;

function shareDirect(){
  const data=`üìÑ CV de ${document.getElementById('fullName').value} (${document.getElementById('profession').value})\nPr√©nom: ${document.getElementById('prenom').value}\n√Çge: ${document.getElementById('age').value}\nVille: ${document.getElementById('ville').value}\nQuartier: ${document.getElementById('quartier').value}\nSituation: ${document.getElementById('situation').value}\nEnfants: ${document.getElementById('enfants').value}\nDernier poste: ${document.getElementById('poste').value}\nLoisirs: ${document.getElementById('loisirs').value}\nCaract√®re: ${document.getElementById('caractere').value}\nDipl√¥me: ${document.getElementById('diplome').value}\n√âtablissement: ${document.getElementById('etablissement').value}\nAlcoolique: ${document.getElementById('alcool').value}\nSalaire: ${document.getElementById('salaire').value}\nEmail: ${document.getElementById('email').value}\nTel MTN: ${document.getElementById('telMtn').value}\nTel Orange: ${document.getElementById('telOrange').value}\n\n‚úâÔ∏è Lettre de Motivation\nPr√©nom: ${document.getElementById('prenomLetter').value}\nNom: ${document.getElementById('nomLetter').value}\nEntreprise: ${document.getElementById('entreprise').value}\nPoste: ${document.getElementById('posteLetter').value}\nContenu: ${document.getElementById('contenu').value}\n\nüó∫Ô∏è Plan de localisation\n${document.getElementById('plan').value}`;
  const url=`https://wa.me/?text=${encodeURIComponent(data)}`;
  window.open(url,'_blank');
}

shareBtn.onclick = () => {
  if(isAdmin){
    shareDirect();
  } else {
    document.getElementById('popupOverlay').style.display='flex';
    result.innerHTML=''; verifyBtn.disabled=true;
  }
}

validateBtn.onclick = () => {
  if(adminInput.value === EXPECTED.admin){
    result.innerHTML='<div class="success">Code admin correct ‚úÖ</div>';
    isAdmin=true;
    verifyBtn.disabled=false;
  } else {
    result.innerHTML='<div class="error">Code admin incorrect ‚ùå</div>';
    isAdmin=false;
    verifyBtn.disabled=true;
  }
}

verifyBtn.onclick = () => {
  const msg=document.getElementById('momoMsg').value.toLowerCase().replace(/\s+/g,'');
  result.innerHTML='';

  const phoneMatch=EXPECTED.phones.some(p=>msg.includes(p));
  if(!phoneMatch){ result.innerHTML='<div class="error">Num√©ro du b√©n√©ficiaire incorrect</div>'; return; }

  const amtMatch=msg.match(/(\d+)/);
  if(!amtMatch || parseInt(amtMatch[0])!==EXPECTED.amount){ result.innerHTML='<div class="error">Montant incorrect</div>'; return; }

  const dateMatch=msg.match(/(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})/);
  if(dateMatch){ const diff=(new Date()-new Date(dateMatch[1]))/60000; if(diff>EXPECTED.maxDelay){ result.innerHTML='<div class="error">D√©lai d√©pass√©</div>'; return; } }

  result.innerHTML='<div class="success">‚úÖ V√©rifi√© ! Partage en cours...</div>';
  shareDirect();
  document.getElementById('popupOverlay').style.display='none';
}

// PWA service worker registration
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('service-worker.js').then(()=>console.log('SW registered'));
}
</script>

</body>
</html>