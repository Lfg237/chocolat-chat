<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tableau Utilisateurs</title>
<style>
body{font-family:Arial,sans-serif;background:#f0f8ff;margin:0;padding:20px;}
table{width:100%;border-collapse:collapse;margin-top:20px;}
th,td{border:1px solid #1e88e5;padding:8px;text-align:center;vertical-align:top;}
th{background:#1e88e5;color:white;}
.paper{background:white;padding:10px;border-radius:5px;box-shadow:0 0 8px rgba(0,0,0,0.1);max-width:250px;margin:auto;}
label{font-weight:bold;}
input,textarea{width:100%;padding:4px;margin:2px 0;border:1px solid #1e88e5;border-radius:4px;}
button{padding:6px 12px;border:none;border-radius:4px;background:#25D366;color:white;font-weight:bold;cursor:pointer;margin-top:4px;}
</style>
</head>
<body>
<h1>ðŸ“‹ Tableau Utilisateurs</h1>

<table>
<thead>
<tr>
<th>Nom / Profession</th>
<th>CV</th>
<th>Lettre</th>
<th>Plan</th>
<th>WhatsApp</th>
</tr>
</thead>
<tbody id="userTable"></tbody>
</table>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
const { jsPDF } = window.jspdf;

// Exemple utilisateurs
const users=[
  {
    nom:"Alice Dupont",
    profession:"DÃ©veloppeuse",
    cv:{prenom:"Alice", age:"28", ville:"Paris", poste:"Frontend", email:"alice@example.com"},
    lettre:{prenom:"Alice", nom:"Dupont", entreprise:"TechCorp", poste:"IngÃ©nieur", contenu:"Motivation pour rejoindre TechCorp."},
    plan:{plan:"123 Rue de Paris"}
  },
  {
    nom:"Bob Martin",
    profession:"Designer",
    cv:{prenom:"Bob", age:"30", ville:"Lyon", poste:"Graphiste", email:"bob@example.com"},
    lettre:{prenom:"Bob", nom:"Martin", entreprise:"DesignInc", poste:"Graphiste", contenu:"Motivation pour DesignInc."},
    plan:{plan:"456 Avenue Lyon"}
  }
];

// GÃ©nÃ©ration PDF pour une section
function downloadPDFFromElement(element, filename){
  html2canvas(element,{scale:2,useCORS:true}).then(canvas=>{
    const imgData=canvas.toDataURL('image/png');
    const pdf=new jsPDF('p','mm','a4');
    const pdfWidth=pdf.internal.pageSize.getWidth();
    const pdfHeight=(canvas.height*pdfWidth)/canvas.width;
    pdf.addImage(imgData,'PNG',0,0,pdfWidth,pdfHeight);
    pdf.save(filename);
  });
}

// CrÃ©e les lignes du tableau
const tbody=document.getElementById('userTable');
users.forEach((user,index)=>{
  const tr=document.createElement('tr');

  // Nom / Profession
  const tdInfo=document.createElement('td');
  tdInfo.innerHTML=`<b>${user.nom}</b><br>${user.profession}`;
  tr.appendChild(tdInfo);

  // CV
  const tdCV=document.createElement('td');
  const divCV=document.createElement('div');
  divCV.className='paper';
  divCV.id=`cv${index}`;
  divCV.innerHTML=`
    <label>PrÃ©nom:</label> ${user.cv.prenom}<br>
    <label>Ã‚ge:</label> ${user.cv.age}<br>
    <label>Ville:</label> ${user.cv.ville}<br>
    <label>Dernier poste:</label> ${user.cv.poste}<br>
    <label>Email:</label> ${user.cv.email}<br>
    <button id="btnCV${index}">ðŸ“¥ CV PDF</button>
  `;
  tdCV.appendChild(divCV);
  tr.appendChild(tdCV);

  // Lettre
  const tdLettre=document.createElement('td');
  const divLettre=document.createElement('div');
  divLettre.className='paper';
  divLettre.id=`lettre${index}`;
  divLettre.innerHTML=`
    <label>PrÃ©nom:</label> ${user.lettre.prenom}<br>
    <label>Nom:</label> ${user.lettre.nom}<br>
    <label>Entreprise:</label> ${user.lettre.entreprise}<br>
    <label>Poste:</label> ${user.lettre.poste}<br>
    <label>Contenu:</label> ${user.lettre.contenu}<br>
    <button id="btnLettre${index}">ðŸ“¥ Lettre PDF</button>
  `;
  tdLettre.appendChild(divLettre);
  tr.appendChild(tdLettre);

  // Plan
  const tdPlan=document.createElement('td');
  const divPlan=document.createElement('div');
  divPlan.className='paper';
  divPlan.id=`plan${index}`;
  divPlan.innerHTML=`
    <label>Plan:</label> ${user.plan.plan}<br>
    <button id="btnPlan${index}">ðŸ“¥ Plan PDF</button>
  `;
  tdPlan.appendChild(divPlan);
  tr.appendChild(tdPlan);

  // WhatsApp
  const tdWA=document.createElement('td');
  const btnWA=document.createElement('button');
  btnWA.textContent='ðŸ“¤ WhatsApp';
  btnWA.onclick=()=> {
    let text=`ðŸ“„ CV de ${user.nom} (${user.profession})\n`;
    text+=`CV: PrÃ©nom: ${user.cv.prenom}, Ã‚ge: ${user.cv.age}, Ville: ${user.cv.ville}, Poste: ${user.cv.poste}, Email: ${user.cv.email}\n`;
    text+=`Lettre: PrÃ©nom: ${user.lettre.prenom}, Nom: ${user.lettre.nom}, Entreprise: ${user.lettre.entreprise}, Poste: ${user.lettre.poste}, Contenu: ${user.lettre.contenu}\n`;
    text+=`Plan: ${user.plan.plan}`;
    window.open(`https://wa.me/?text=${encodeURIComponent(text)}`,'_blank');
  };
  tdWA.appendChild(btnWA);
  tr.appendChild(tdWA);

  tbody.appendChild(tr);

  // Attache PDF buttons
  document.getElementById(`btnCV${index}`).onclick=()=>downloadPDFFromElement(divCV, `CV_${user.nom}.pdf`);
  document.getElementById(`btnLettre${index}`).onclick=()=>downloadPDFFromElement(divLettre, `Lettre_${user.nom}.pdf`);
  document.getElementById(`btnPlan${index}`).onclick=()=>downloadPDFFromElement(divPlan, `Plan_${user.nom}.pdf`);
});
</script>
</body>
</html>