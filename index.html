<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CV / Lettre / Plan</title>
<style>
body{font-family:Arial,sans-serif;background:#e0f7fa;margin:0;padding:10px;}
section{padding:15px;border-radius:10px;margin-bottom:15px;box-shadow:0 2px 5px rgba(0,0,0,0.1);}
#cv{background:#fff9c4;} /* Jaune clair */
#lettre{background:#c8e6c9;} /* Vert clair */
#plan{background:#bbdefb;} /* Bleu clair */
input,textarea,button{width:100%;padding:8px;margin:6px 0;border:1px solid #1e90ff;border-radius:6px;}
button{cursor:pointer;}
button.primary{background:#25D366;color:#fff;font-weight:700;border:none;font-size:1rem;}
#popupOverlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.6);justify-content:center;align-items:center;}
#popup{background:#fff;padding:15px;border-radius:10px;width:100%;max-width:400px;}
.result{margin:5px 0;font-weight:bold;}
</style>
</head>
<body>

<h1>üìÑ CV / Lettre de Motivation / Plan</h1>

<section id="cv">
<h2>üë§ CV</h2>
<input id="fullName" placeholder="Nom complet">
<input id="profession" placeholder="Profession / poste">
<input id="prenom" placeholder="Pr√©nom">
<input id="age" placeholder="√Çge">
<input id="ville" placeholder="Ville">
<input id="quartier" placeholder="Quartier">
<input id="situation" placeholder="Situation matrimoniale">
<input id="enfants" placeholder="Nombre d'enfants">
<input id="poste" placeholder="Dernier poste">
<input id="loisirs" placeholder="Loisirs">
<input id="caractere" placeholder="Caract√®re">
<input id="diplome" placeholder="Dernier dipl√¥me">
<input id="etablissement" placeholder="√âtablissement">
<input id="alcool" placeholder="Alcoolique Oui/Non">
<input id="salaire" placeholder="Salaire">
<input id="email" placeholder="Email">
<input id="telMtn" placeholder="Tel MTN">
<input id="telOrange" placeholder="Tel Orange">
</section>

<section id="lettre">
<h2>‚úâÔ∏è Lettre de motivation</h2>
<input id="prenomLetter" placeholder="Pr√©nom">
<input id="nomLetter" placeholder="Nom">
<input id="entreprise" placeholder="Entreprise">
<input id="posteLetter" placeholder="Poste souhait√©">
<textarea id="contenu" placeholder="Contenu"></textarea>
</section>

<section id="plan">
<h2>üó∫Ô∏è Plan de localisation</h2>
<textarea id="planText" placeholder="Plan de localisation"></textarea>
</section>

<button id="shareBtn" class="primary">üì§ Partager sur WhatsApp</button>
<button id="downloadPdf" class="primary">üì• T√©l√©charger PDF</button>

<!-- Popup paiement -->
<div id="popupOverlay">
<div id="popup">
<h2>Paiement requis</h2>
<p>B√©n√©ficiaire: Wirnkar Loveline</p>
<p>MTN MoMo: 676353859<br>OM: 640647072<br>Montant: 25 FCFA</p>
<textarea class="momoMsg" placeholder="Message Mobile Money"></textarea>
<input class="adminCode" type="password" placeholder="Code admin">
<div class="result"></div>
<button class="validateAdminBtn primary">‚úÖ Valider code admin</button>
<button class="verifyBtn primary">‚úÖ V√©rifier & Partager</button>
<button onclick="document.getElementById('popupOverlay').style.display='none'">Annuler</button>
</div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script>
const EXPECTED={phones:['676353859','640647072'],amount:25,admin:'233233',maxDelay:5};
let isAdmin=false;

const shareBtn=document.getElementById('shareBtn');
const downloadBtn=document.getElementById('downloadPdf');
const popup=document.getElementById('popupOverlay');
const momoMsg=popup.querySelector('.momoMsg');
const adminInput=popup.querySelector('.adminCode');
const validateBtn=popup.querySelector('.validateAdminBtn');
const verifyBtn=popup.querySelector('.verifyBtn');
const result=popup.querySelector('.result');

function getAllHTML(){
  const cvFields={"Nom":document.getElementById('fullName').value,"Profession":document.getElementById('profession').value,"Pr√©nom":document.getElementById('prenom').value,"√Çge":document.getElementById('age').value,"Ville":document.getElementById('ville').value,"Quartier":document.getElementById('quartier').value,"Situation":document.getElementById('situation').value,"Enfants":document.getElementById('enfants').value,"Dernier poste":document.getElementById('poste').value,"Loisirs":document.getElementById('loisirs').value,"Caract√®re":document.getElementById('caractere').value,"Dipl√¥me":document.getElementById('diplome').value,"√âtablissement":document.getElementById('etablissement').value,"Alcoolique":document.getElementById('alcool').value,"Salaire":document.getElementById('salaire').value,"Email":document.getElementById('email').value,"Tel MTN":document.getElementById('telMtn').value,"Tel Orange":document.getElementById('telOrange').value};
  const lettreFields={"Pr√©nom":document.getElementById('prenomLetter').value,"Nom":document.getElementById('nomLetter').value,"Entreprise":document.getElementById('entreprise').value,"Poste":document.getElementById('posteLetter').value,"Contenu":document.getElementById('contenu').value};
  const planFields={"Plan":document.getElementById('planText').value};

  function buildSection(title,fields,bg){let s=`<section style="background:${bg};padding:10px;border-radius:8px;margin-bottom:10px;"><h2>${title}</h2>`;for(let k in fields){s+=`<p>${k}: ${fields[k]}</p>`;}s+='</section>';return s;}
  return buildSection("CV",cvFields,"#fff9c4")+buildSection("Lettre de motivation",lettreFields,"#c8e6c9")+buildSection("Plan de localisation",planFields,"#bbdefb");
}

function getAllText(){
  let text=`üìÑ CV de ${document.getElementById('fullName').value} (${document.getElementById('profession').value})\n\n`;
  const inputsCV=document.getElementById('cv').querySelectorAll('input');
  inputsCV.forEach(i=>text+=`${i.placeholder}: ${i.value}\n`);
  const inputsLet=document.getElementById('lettre').querySelectorAll('input,textarea');
  inputsLet.forEach(i=>text+=`${i.placeholder}: ${i.value}\n`);
  const plan=document.getElementById('planText').value;
  text+=`Plan: ${plan}\n`;
  return text;
}

// WhatsApp partage
shareBtn.onclick = ()=>{
  if(isAdmin){window.open(`https://wa.me/?text=${encodeURIComponent(getAllText())}`,'_blank');}
  else popup.style.display='flex';
};

// Admin code
validateBtn.onclick = ()=>{
  if(adminInput.value===EXPECTED.admin){isAdmin=true;result.innerHTML='<span style="color:green">Code admin correct ‚úÖ</span>';popup.style.display='none';}
  else result.innerHTML='<span style="color:red">Code admin incorrect ‚ùå</span>';
};

// Mobile Money verify
verifyBtn.onclick = ()=>{
  const msg=momoMsg.value.toLowerCase().replace(/\s+/g,''); result.innerHTML='';
  if(!EXPECTED.phones.some(p=>msg.includes(p))){ result.innerHTML='<span style="color:red">Num√©ro incorrect</span>'; return; }
  const amt=msg.match(/(\d+)/); if(!amt || parseInt(amt[0])!==EXPECTED.amount){ result.innerHTML='<span style="color:red">Montant incorrect</span>'; return; }
  result.innerHTML='<span style="color:green">‚úÖ V√©rifi√© ! Partage en cours...</span>';
  popup.style.display='none';
  window.open(`https://wa.me/?text=${encodeURIComponent(getAllText())}`,'_blank');
};

// T√©l√©charger PDF
downloadBtn.onclick = ()=>{
  const tempDiv=document.createElement('div');
  tempDiv.style.position='absolute'; tempDiv.style.left='-9999px';
  tempDiv.innerHTML=getAllHTML(); document.body.appendChild(tempDiv);
  html2pdf().from(tempDiv).set({margin:10,filename:'document.pdf',html2canvas:{scale:2,useCORS:true},jsPDF:{unit:'mm',format:'a4',orientation:'portrait'}}).save().finally(()=>document.body.removeChild(tempDiv));
};
</script>
</body>
</html>