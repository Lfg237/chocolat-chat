<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CV / Lettre / Plan</title>
<style>
body{font-family:Arial,sans-serif;background:#e0f7fa;margin:0;padding:10px;}
.paper{background:white;padding:20px;margin:20px auto;max-width:900px;box-shadow:0 0 15px rgba(0,0,0,0.2);border-radius:5px;}
header{text-align:center;margin-bottom:10px;}
header h1{font-size:2em;font-weight:bold;margin:0;}
header h2{font-size:1em;color:#555;margin:5px 0;}
section{margin-bottom:15px;padding:15px;border:1px solid #ccc;border-radius:5px;}
section h3{margin-top:0;color:#1e88e5;}
input,textarea{width:100%;padding:6px;margin:5px 0;border:1px solid #1e88e5;border-radius:4px;}
label{font-weight:bold;}
button{padding:10px;margin:5px 0;border:none;border-radius:5px;background:#25D366;color:white;font-weight:bold;cursor:pointer;}
#photoPreview{display:none;width:120px;height:120px;border-radius:10px;margin-bottom:10px;}
</style>
</head>
<body>

<h1>📄 CV / Lettre / Plan</h1>

<!-- CV -->
<div class="paper" id="cv">
<header>
<h1 id="cvName">Nom Complet</h1>
<h2 id="cvProfession">Profession</h2>
</header>
<section>
<h3>📸 Photo (facultatif)</h3>
<input type="file" id="cvPhoto" accept="image/*">
<img id="cvPhotoPreview">
</section>
<section>
<h3>👤 CV</h3>
<label>Nom complet</label><input id="cvFullName" placeholder="Nom complet">
<label>Profession / poste</label><input id="cvProf" placeholder="Profession / poste">
<label>Prénom</label><input id="cvPrenom" placeholder="Prénom">
<label>Âge</label><input id="cvAge" placeholder="Âge">
<label>Ville</label><input id="cvVille" placeholder="Ville">
<label>Quartier</label><input id="cvQuartier" placeholder="Quartier">
<label>Situation matrimoniale</label><input id="cvSituation" placeholder="Situation matrimoniale">
<label>Nombre d'enfants</label><input id="cvEnfants" placeholder="Nombre d'enfants">
<label>Dernier poste</label><input id="cvPoste" placeholder="Dernier poste">
<label>Loisirs</label><input id="cvLoisirs" placeholder="Loisirs">
<label>Caractère</label><input id="cvCaractere" placeholder="Caractère">
<label>Dernier diplôme</label><input id="cvDiplome" placeholder="Dernier diplôme">
<label>Établissement</label><input id="cvEtablissement" placeholder="Établissement">
<label>Alcoolique Oui/Non</label><input id="cvAlcool" placeholder="Alcoolique Oui/Non">
<label>Salaire</label><input id="cvSalaire" placeholder="Salaire">
<label>Email</label><input id="cvEmail" placeholder="Email">
<label>Tel MTN</label><input id="cvTelMtn" placeholder="Tel MTN">
<label>Tel Orange</label><input id="cvTelOrange" placeholder="Tel Orange">
</section>
<button id="downloadCV">📥 Télécharger CV</button>
</div>

<!-- Lettre -->
<div class="paper" id="lettre">
<section>
<h3>✉️ Lettre de motivation</h3>
<label>Prénom</label><input id="lettrePrenom" placeholder="Prénom">
<label>Nom</label><input id="lettreNom" placeholder="Nom">
<label>Entreprise</label><input id="lettreEntreprise" placeholder="Entreprise">
<label>Poste souhaité</label><input id="lettrePoste" placeholder="Poste souhaité">
<label>Contenu</label><textarea id="lettreContenu" placeholder="Contenu"></textarea>
</section>
<button id="downloadLettre">📥 Télécharger Lettre</button>
</div>

<!-- Plan -->
<div class="paper" id="plan">
<section>
<h3>🗺️ Plan de localisation</h3>
<label>Plan</label><textarea id="planTexte" placeholder="Plan de localisation"></textarea>
</section>
<button id="downloadPlan">📥 Télécharger Plan</button>
</div>

<!-- WhatsApp -->
<button id="shareBtn">📤 Partager sur WhatsApp</button>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
const { jsPDF } = window.jspdf;

// Nom/profession dynamique
const cvFullName=document.getElementById('cvFullName');
const cvProf=document.getElementById('cvProf');
cvFullName.addEventListener('input',()=>document.getElementById('cvName').textContent=cvFullName.value || "Nom Complet");
cvProf.addEventListener('input',()=>document.getElementById('cvProfession').textContent=cvProf.value || "Profession");

// Photo preview
const cvPhoto=document.getElementById('cvPhoto');
const cvPhotoPreview=document.getElementById('cvPhotoPreview');
cvPhoto.addEventListener('change', e=>{
  const file=e.target.files[0];
  if(file){
    const reader=new FileReader();
    reader.onload=function(ev){cvPhotoPreview.src=ev.target.result; cvPhotoPreview.style.display='block';}
    reader.readAsDataURL(file);
  }
});

// Fonction PDF par section
function downloadPDF(sectionId, filename){
  const section=document.getElementById(sectionId);
  html2canvas(section,{scale:2,useCORS:true}).then(canvas=>{
    const imgData=canvas.toDataURL('image/png');
    const pdf=new jsPDF('p','mm','a4');
    const pdfWidth=pdf.internal.pageSize.getWidth();
    const pdfHeight=(canvas.height*pdfWidth)/canvas.width;
    pdf.addImage(imgData,'PNG',0,0,pdfWidth,pdfHeight);
    pdf.save(filename);
  });
}

document.getElementById('downloadCV').onclick=()=>downloadPDF('cv','CV.pdf');
document.getElementById('downloadLettre').onclick=()=>downloadPDF('lettre','Lettre.pdf');
document.getElementById('downloadPlan').onclick=()=>downloadPDF('plan','Plan.pdf');

// WhatsApp
document.getElementById('shareBtn').onclick=()=>{
  let text=`📄 CV de ${cvFullName.value} (${cvProf.value})\n\n`;
  document.querySelectorAll('#cv input').forEach(i=>text+=`${i.previousElementSibling.textContent}: ${i.value}\n`);
  document.querySelectorAll('#lettre input, #lettre textarea').forEach(i=>text+=`${i.previousElementSibling.textContent}: ${i.value}\n`);
  text+=`Plan: ${document.getElementById('planTexte').value}\n`;
  window.open(`https://wa.me/?text=${encodeURIComponent(text)}`,'_blank');
};
</script>
</body>
</html>